package com.tao.failreason;

import com.tao.app.ServiceApp;
import jakarta.annotation.Resource;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;

@SpringBootTest
class RagResultValidatorTest {

    @Resource
    private RagResultValidator ragResultValidator;

    @Resource
    private ServiceApp serviceApp;

    @Test
    void testIsValidRagResult() {
        // 使用有效的对话内容作为测试数据
        String info = """
            客服：您好，请问是13172306204的机主吗？
            客户：啊，是。
            客服：感谢您的接听。这边是广州联通给您来电的，就是留意到您的号码是24年十月份入网的嘛，想让您这个卡长期使用保留下来多多支持联通的那今晚八点之后呢，会帮您做1个网络提速，您还是按您这个司机全国流量到29的卡来用不调整月费的，您放心。另外呢还可以体验1个每月多交20元活动发信用消费。按照您这个卡29的这个4G全国流量网缴费就可以，每个月还可以体验1个一百五十分钟通话和五个G流量。这样您所有资源呢就可以使用5G啦，就是您这个4G全国流量完升级成5G全国流量。哇，而且二29的这个卡利用就可以。
            客服：这样您这两天有空的话，把手机呢关机重启1下，网络，帮您更新好办理好呢，到时候留意使用就可以了，好吧。
            客户：啊，好，知道是。
            客服：嗯，另外呢耽误您二三十秒，就是稍后呢10016系统会发1条短信给您收到短信呢回复1个八，就是确认号码是您在用就可以。您看1下10016的短信收到了吗？
            客服：就是包含150分钟五个G流量的这条短信短信框回复一个八确认号码是您在用。
            客服：用。
            客户：那个为什么要要音频要6块呀什么的那个呢？
            客服：您放心女士，这个活动它是标价20元的活动，但是号码的话已经给您优化过啦。这个是公司感恩回馈联通优质用户的。就是你这个号码呢，保持正常使用。
            客服：系统给您优化，过入到咱产品里的，不调整营月费的放心就可以。
            客服：还有嗯有1个音是特惠包，这个是每月多交6元的1个体验1次，就是本月不交钱呢，可以体验1个十G流量的7天，有效会有短信通知您的，到时候留意用就可以。
            客户：还是后面这些收钱呢？
            客服：不调整您运费的女士。
            客户：如果调整，我就。
            客服：是联通公司，联通公司感恩回馈优质用户的给您优化过了，就是归入到您的这个产品里的，您不是办理的一个四G全国流量吗？29的吗？这样给您优化升级之后呢，您还是29的这个套卡，就是信号给您优化，您这样就可以使用，就升级成5G的这个流量，完29啦。
            客服：其他的。
            客户：其实我那时候买台的时候，他已经说是5G的他但是他为什么给我开4G都没想到。
            客服：嗯。
            客户：嗯。
            客服：您的手机是支持5G但是您当时入网24年不是十月份入网的吗？您办的是一个四G全国流量吗？29的这样给您升级之后，这个就是不需要您更改更贵的那种5G套餐了，就可以直接升级成29的5G卡了。
            客户：好。
            客户：哎，你如果用现在售钱的话，我再投诉啊。
            客服：您放心，女士，这边是系统给您优化过来的，就是感恩回馈联通用户的嘛。
            客户：可以。
            客服：它这个每月多加20元的活动，是就是你还是保留您当前的这个套卡来用。
            客服：用。
            客户：哦，好，那我给你试1下。
            客服：嗯，稍后呢嗯对您说一个八确认一号码是您在用。
            客服：用。
            客服：另外耽误您几秒钟，就是为您登记办理的，每月交多20元的这个5G加油包呀。工作人员会在3个工作日内给您批量更新。您这两天有时间呢，关机重启1下啦。这个生效后期客资源自动续订的语音不完，不转接，流量用不完，那可以转到下个月来继续用的。
            客户：啊，这个这个我知道我1直在用户。
            客服：嗯，这个赠款不抵扣，就是本月可以不交钱，体验一个十G流量7天有效的。
            客户：您现在怎么说够用，但是你说的那个谁私下带这个。
            客服：另外，您小。
            客服：嗯。
            客户：如果你原来都扣费的话，我就我就申请那个啊。
            客户：嗯。
            客服：另外就是麻烦女士稍后收到语音提示呢，麻烦按个1对我的服务评个满意，您的满意对我非常重要，谢谢。
            客户：啊。
            客户：啊，好。
            客服：这样就不打扰您了，生活愉快再见。
            客户：那再见。
            客户：再见。
        """;

        // 测试isValidRagResult方法
        boolean result = ragResultValidator.isValidRagResult(info);
        System.out.println("=== RagResultValidator 测试输出 ===");
        System.out.println("isValidRagResult: " + result);

        // 由于实际的RAG结果可能会有所不同，这里只断言返回值是boolean类型
        Assertions.assertTrue(result || !result);
    }
}